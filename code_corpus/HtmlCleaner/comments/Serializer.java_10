    /**
     * Writes specified node using specified writer.
     * 
     * @param tagNode
     *            Node to serialize.
     * @param writer
     *            Writer instance
     * @param charset
     *            Charset of the output
     * @param omitEnvelope
     *            Tells whether to skip open and close tag of the node.
     * @throws IOException
     */
