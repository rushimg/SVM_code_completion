    /**
     * Writes specified TagNode to the file, using specified charset and
     * optionally omits node envelope (skips open and close tags of the node).
     * 
     * @param tagNode
     *            Node to be written
     * @param fileName
     *            Output file name
     * @param omitEnvelope
     *            Tells whether to skip open and close tag of the node.
     * @throws IOException
     */
