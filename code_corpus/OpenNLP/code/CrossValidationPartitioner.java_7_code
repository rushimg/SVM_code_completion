    public ObjectStream<E> getTestSampleStream() throws IOException {

      if (isPoisened) {
        throw new IllegalStateException();
      }

      if (testSampleStream == null) {

        sampleStream.reset();
        testSampleStream =  new TestSampleStream<E>(sampleStream, numberOfPartitions, testIndex);
      }

      return testSampleStream;
    }
  }

