  public abstract double valueAt(double[] x, double xScale, int[] batch);

  public double valueAt(double[] x, double xScale, int batchSize) {
    getBatch(batchSize);
    return valueAt(x, xScale, thisBatch);
  }

