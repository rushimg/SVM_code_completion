  protected Pair<? extends InputStream, CloseAction> newInputStream(File f) throws IOException {
    final FileSemaphore lock = acquireFileLock(f);
    final ObjectInputStream rtn = new ObjectInputStream(new GZIPInputStream(new BufferedInputStream(new FileInputStream(f))));
    return new Pair<ObjectInputStream, CloseAction>(rtn,
        new CloseAction(){
          @Override
          public void apply() throws IOException { lock.release(); rtn.close();  }
        });
  }

