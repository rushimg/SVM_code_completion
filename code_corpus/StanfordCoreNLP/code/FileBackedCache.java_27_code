  @SuppressWarnings("unchecked")
  protected Pair<KEY, T> readNextObjectOrNull(InputStream input) throws IOException, ClassNotFoundException {
    try {
      return (Pair<KEY, T>) ((ObjectInputStream) input).readObject();
    } catch (EOFException e) {
      return null; // I hate java
    }
  }

